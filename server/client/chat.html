<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Чат | Chayka</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <div class="chat-wrapper">
    <aside class="rooms-sidebar">
      <div class="current-user">
        <i class="fas fa-user-circle"></i>
        <span>Вы: <span id="current-user">Иван Иванов</span></span>
        <span class="online-dot"></span>
      </div>
      
      <div class="sidebar-divider"></div>
      
      <div class="sidebar-section">
        <div class="section-title">Чаты</div>
        <button id="create-group-btn" class="sidebar-btn">
          <i class="fas fa-users"></i> Создать группу
        </button>
        <button id="create-channel-btn" class="sidebar-btn">
          <i class="fas fa-bullhorn"></i> Создать канал
        </button>
      </div>
      
      <div class="sidebar-section">
        <h2><i class="fas fa-comments"></i> Мои чаты</h2>
        <ul id="rooms-list" class="rooms-list">
          <li class="active"><i class="fas fa-user-friends"></i> Общий чат</li>
          <li><i class="fas fa-user-friends"></i> Рабочая группа</li>
          <li><i class="fas fa-user-friends"></i> Друзья <span class="unread-count">3</span></li>
          <li><i class="fas fa-bullhorn"></i> Новости проекта</li>
        </ul>
      </div>
      
      <div class="sidebar-section">
        <h2><i class="fas fa-user-friends"></i> Контакты</h2>
               <aside class="rooms-sidebar">
          <!-- ... -->
          <div class="search-container">
            <input type="text" id="global-search" placeholder="Найти @пользователя или &канал">
            <ul id="search-results" class="rooms-list" style="display: none;"></ul>
            <ul id="users-list" class="rooms-list" style="display: none;"></ul>
          </div>
          <!-- ... -->
        </aside>
        <ul id="users-list" class="rooms-list">
          <li><i class="fas fa-user"></i> Анна Петрова <span class="online-dot"></span></li>
          <li><i class="fas fa-user"></i> Максим Сидоров</li>
          <li><i class="fas fa-user"></i> Ольга Иванова <span class="online-dot"></span></li>
          <li><i class="fas fa-user"></i> Дмитрий Васильев</li>
        </ul>
      </div>
      
      <div class="sidebar-section">
        <div class="section-title">Мини-приложения</div>
        <button id="btn-weather" class="sidebar-btn">
          <i class="fas fa-sun"></i> Погода
        </button>
        <button id="btn-calendar" class="sidebar-btn">
          <i class="fas fa-calendar"></i> Журнал
        </button>
        <button id="btn-finance" class="sidebar-btn">
          <i class="fas fa-wallet"></i> Финансы
        </button>
      </div>
      
      <div class="sidebar-section">
        <div class="section-title">Игровая зона</div>
        <button id="btn-strike-game" class="sidebar-btn">
          <i class="fas fa-gamepad"></i> Galactic Annihilator
        </button>
        <button id="btn-match3-game" class="sidebar-btn">
          <i class="fas fa-puzzle-piece"></i> Galactic Match-3
        </button>
        <button id="btn-runner-game" class="sidebar-btn">
          <i class="fas fa-running"></i> Бегунок
        </button>
      </div>
      
      <div class="sidebar-divider"></div>
      
      <div class="sidebar-section">
        <div class="section-title">Настройки</div>
        <button id="btn-settings" class="sidebar-btn">
          <i class="fas fa-cog"></i> Настройки профиля
        </button>
        <button id="btn-logout" class="sidebar-btn" style="background: rgba(248,113,113,0.1); color: #f87171;">
          <i class="fas fa-sign-out-alt"></i> Выход
        </button>
      </div>
    </aside>

    <section id="chat-section" class="chat-container active">
      <div class="chat-message-area">
        <div id="chat-header" class="chat-header">
          <div class="chat-header__left">
            <h3><i class="fas fa-user-friends"></i> Общий чат</h3>
          </div>
          <div class="chat-header__actions">
            <button id="add-member-btn" class="icon-btn chat-header__call-btn" title="Добавить участников">
              <i class="fas fa-user-plus"></i>
            </button>
            <button id="call-btn" class="icon-btn chat-header__call-btn">
              <i class="fas fa-phone"></i>
            </button>
          </div>
        </div>

        <div id="chat-box" class="chat-box">
          <div class="system-call-wrapper">
            <div class="system-call">
              Вы присоединились к чату
            </div>
          </div>
          
          <div class="message-wrapper">
            <div class="other-message">
              <div class="message-info">
                <span>Анна Петрова</span>
                <span>10:25</span>
              </div>
              <div class="message-bubble">
                <div class="message-text">Привет всем! Как ваши дела? Готовы к совещанию в 15:00?</div>
              </div>
            </div>
          </div>
          
          <div class="message-wrapper">
            <div class="my-message">
              <div class="message-info">
                <span>Вы</span>
                <span>10:28</span>
              </div>
              <div class="message-bubble">
                <div class="message-text">Привет! Да, готов. Уже посмотрел материалы. Кстати, посмотрите новый дизайн интерфейса!</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="chat-input-wrapper">
        <div class="input-container" id="input-container">
          <button id="attach-btn" class="icon-btn">
            <i class="fas fa-paperclip"></i>
          </button>
          <textarea id="message" placeholder="Введите сообщение..." rows="1"></textarea>
          <button id="send-btn" class="icon-btn">
            <i class="fas fa-paper-plane"></i>
          </button>
          <button id="voice-btn" class="icon-btn">
            <i class="fas fa-microphone"></i>
          </button>
        </div>
      </div>
    </section>
  </div>

  <!-- Lightbox Overlay -->
  <div id="lightbox-overlay" class="hidden">
    <div id="lightbox-content">
      <button id="lightbox-close">✕</button>
      <button id="lightbox-download">⤓</button>
      <img id="lightbox-image" src="" alt="Preview">
    </div>
  </div>
  <!-- Окно звонка -->
  <div id="call-window" class="call-window hidden">
    <div class="call-header">
      <span id="call-title">Звонок с ...</span>
    </div>
    <div class="call-body">
      <div id="call-status">Ожидание...</div>
      <div id="call-timer">00:00</div>
      <audio id="remote-audio" autoplay></audio>
      <div class="call-controls">
        <button id="call-answer" class="action-btn">Ответить</button>
        <button id="call-cancel" class="action-btn cancel">Отмена</button>
      </div>
    </div>
  </div>

  <div id="group-modal" class="hidden">
  <div class="modal-overlay"></div>
  <div class="modal-window">
    <h3>Новая группа</h3>
    <div id="group-name-wrapper">
      <label>
        Название группы:
        <input type="text" id="group-name-input" placeholder="Введите название">
      </label>
    </div>
    <label>
      Добавить участников:
      <input type="text" id="group-user-search" placeholder="Поиск по никам">
    </label>
    <ul id="group-user-suggestions" class="suggestions-list"></ul>
    <div id="group-selected-users" class="selected-list"></div>
    <div class="modal-actions">
      <button id="group-cancel-btn">Отмена</button>
      <button id="group-create-btn">Создать</button>
    </div>
  </div>
</div>

  <!-- Модалка для добавления участников -->
<div id="add-member-modal" class="hidden">
  <div class="modal-overlay"></div>
  <div class="modal-window">
    <h3>Добавить участников</h3>
    <label>
      Поиск по никам:
      <input type="text" id="add-user-search" placeholder="Введите ник">
    </label>
    <ul id="add-user-suggestions" class="suggestions-list"></ul>
    <div id="add-selected-users" class="selected-list"></div>
    <div class="modal-actions">
      <button id="add-cancel-btn">Отмена</button>
      <button id="add-confirm-btn">Добавить</button>
    </div>
  </div>
</div>
  <iframe
    id="scheduler-frame"
    src="/miniapps/calendar/index.html"
    style="display:none;"
    allow="autoplay; notifications"
  ></iframe>
<!-- В вашем index.html или шаблоне -->
<div id="modal" style="display:none;">
  <div id="modal-content">
    <span id="modal-close">&times;</span>
    <iframe
      id="modal-frame"
      src=""
      allow="autoplay; notifications"
      style="border: none; width:100%; height:100%;"
    ></iframe>
  </div>
</div>

  <div id="game-modal" class="modal">
  <div class="modal-content game-modal-content">
    <span class="close-game">&times;</span>
    <iframe id="game-frame" class="game-frame"></iframe>
  </div>
</div>

<!-- Добавить перед закрывающим тегом body -->
<div id="settings-modal" class="modal" style="display:none;">
  <div class="modal-content">
    <span class="close-modal" id="settings-close">&times;</span>
    <h3>Настройки профиля</h3>
    <form id="settings-form">
      <div class="form-group">
        <label for="settings-nickname">Никнейм</label>
        <input type="text" id="settings-nickname" required>
      </div>
      <div class="form-group">
        <label for="settings-bio">Био</label>
        <textarea id="settings-bio" rows="3" placeholder="Расскажите о себе"></textarea>
      </div>
      <div class="form-group">
        <label for="settings-birthdate">Дата рождения</label>
        <input type="date" id="settings-birthdate">
      </div>
<!-- Замените текущий переключатель на этот -->
<div class="theme-switch-wrapper">
  <span class="theme-label">Светлая</span>
  
  <label class="theme-switch">
    <input type="checkbox" id="theme-toggle" hidden>
    <span class="slider">
      <span class="sun-icon">☀️</span>
      <span class="moon-icon">🌙</span>
      <span class="slider-ball"></span>
    </span>
  </label>
  
  <span class="theme-label">Тёмная</span>
</div>
     <!-- Внутри settings-modal, после остальных полей -->
      <div class="form-actions">
        <button type="button" id="settings-cancel">Отмена</button>
        <button type="submit">Сохранить</button>
      </div>
    </form>
  </div>
</div>
  <script src="chat.js"></script>
</body>
</html>
